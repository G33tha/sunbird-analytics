---
# tasks file for start
- name: Copy Scripts - Model Config
  become: yes
  template: src=run-secor.j2 dest=/home/ec2-user/secor-raw/run-secor.sh mode=755 owner=ec2-user group=ec2-user

- name: Stop the Secor service
  become: yes
  become_user: ec2-user
  command: run-secor.sh stop
  args:
    chdir: /home/ec2-user/secor-raw
  async: 10
  poll: 5

- name: Unarchive api artifact
  become: yes
  become_user: ec2-user
  unarchive: src=/mnt/secor/secor-0.2-SNAPSHOT-bin.tar.gz dest=/home/ec2-user/secor-raw copy=no group=ec2-user owner=ec2-user

- name: Start the Secor service
  become: yes
  become_user: ec2-user
  command: run-secor.sh start
  args:
    chdir: /home/ec2-user/secor-raw
  async: 20
  poll: 5